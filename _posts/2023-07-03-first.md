---
layout: single
title:  "[Unity] Monobehaviour"
author_profile: false
tag : [Unity]
categories : Unity
typora-root-url: ../
---

> ## 개요

유니티에서 C# 스크립트를 생성하면 아래 사진과 같은 템플릿으로 나옵니다. 

![image-20230703180914521](/images/2023-07-03-first/image-20230703180914521.png)

MonoBehaviour 클래스는 무심코 지나칠 수 있지만 유니티에서 중요 클래스 카테고리에 넣어놓을 정도로 중요한 클래스입니다. 오늘은 MonoBehaviour 클래스가 무엇인지, 그리고 MonoBehaviour를 상속받아야 사용 가능한 유니티 이벤트에 대해 알아봤습니다.

이벤트 함수에는 다양한 함수들이 있지만 오늘은 Awake, OnEnable, Start, Update, FixedUpdate, LateUpdate, OnDisable, OnDestroy에 대해서 적었습니다.



> ## MonoBehaviour란?

MonoBehaviour 클래스는 유니티 스크립트가 파생되는 기본 클래스입니다. 유니티에서 C# 스크립트를 생성하면 자동으로 상속받습니다. Unity가 제공하는 각종 이벤트 함수 같은 프레임워크를 사용하기 위해서는 MonoBehaviour를 상속받아야 합니다.



> ## 이벤트 함수란?

[스크립트 수명 주기](https://docs.unity3d.com/kr/2021.3/Manual/ExecutionOrder.html)

유니티는 스크립트가 실행되면 사전에 지정한 순서대로 이벤트 함수가 실행되는데 이를 스크립트 수명 주기라고 합니다. 이벤트 함수는 이 수명 주기의 각 단계에 대응되는 함수들입니다. MonoBehaviour를 상속받은 클래스는 각 단계에 대응되는 이벤트 함수가 호출되기 때문에 언제 호출되는지 정확히 알아야 올바르게 사용할 수 있습니다. 그리고 미리 씬에 배치된 같은 이벤트 함수를 사용하는 여러 개의 MonoBehaviour가 있다고 가정할 때 누구의 이벤트 함수가 먼저 호출될지 알 수 없기 때문에 주의해야 합니다. 하지만 동적으로 생성된 경우에는 먼저 생성된 스크립트들의 이벤트 함수가 실행되기 때문에 호출 순서를 정할 수 있습니다.



- 테스트 스크립트(이벤트 함수 로그, 동적 생성)

![image-20230703192420449](/images/2023-07-03-first/image-20230703192420449.png)

![image-20230703194029741](/images/2023-07-03-first/image-20230703194029741.png)



<br>



- 미리 씬에 배치한 경우 아래와 같이 이벤트 함수 순서가 달라질 수 있습니다.

![Scene](/images/2023-07-03-first/Scene-1688380893130-2.png)



- 동적으로 생성하는 경우 생성된 순서대로 이벤트 함수가 호출됩니다.

![Scene](/images/2023-07-03-first/Scene-1688381033173-4.png)





> ## 이벤트 함수의 종류

- **Awake**

씬이 시작할 때 한 번만 호출되는 함수입니다. 만약 씬이 시작할 때 게임 오브젝트가 비활성화된 상태라면 활성화되기 전까지 호출되지 않습니다.

스크립트가 비활성화 상태라도 게임오브젝트가 활성화된 상태라면 Awake 함수는 호출됩니다.

<br>

- **OnEnable**

스크립트 혹은 게임오브젝트가 활성화 될 때마다 호출되는 함수입니다. Awake가 호출된 이후 바로 호출됩니다.

<br>

- **Start**

첫 번째 프레임 업데이트 시작 전에 호출됩니다. 스크립트와 게임오브젝트 둘다 활성화 상태인 경우에만 호출됩니다. 만약 둘 중 하나라도 비활성화 상태라면 활성화된 이후 호출됩니다.

<br>

- **FixedUpdate**

고정된 주기마다 실행되는 함수입니다. 만약 이전 호출시간과 현재 사이의 시간이 고정 주기의 2배 이상인 경우 [흘러간시간/고정주기] 번 만큼 실행됩니다.

<br>

- **Update**

매 프레임마다 한 번 호출되는 함수입니다.

<br>

- **LateUpdate**

모든 MonoBehaviour 클래스의 Update가 완료된 이후 호출되며 매 프레임마다 한 번 호출되는 함수입니다.

<br>

- **OnDisable**

스크립트 혹은 게임오브젝트가 비활성화 될 때마다 호출되는 함수입니다. 둘 중 하나라도 비활성화된 상태에서 나머지 하나를 비활성화시키는 경우 호출되지 않습니다.

<br>

- **OnDestroy**

게임오브젝트 혹은 스크립트가 삭제될 때 호출됩니다.



> ## Update가 여러개 있는 이유

Update함수에는 FixedUpdate와 Update, LateUpdate가 있습니다. 왜 Update 하나로 통합하지 않고 여러 개로 나눠놨을까요?



먼저 FixedUpdate는 컴퓨터 사양 등의 이유로 유저의 프레임 속도가 다르더라도 고정적인 주기로 호출이 보장됩니다. 이는 실수 계산 시 유저끼리의 오차를 줄여 정확한 계산을 가능하게 합니다. 만약 60FPS인 유저와 30FPS인 유저가 있다고 가정할 때, 60FPS인 유저는 2배 더 많은 계산이 일어나기 때문에 그만큼 오차도 커집니다. 이는 물리 연산 같이 세밀한 작업을 할 때 치명적일 수 있기 때문에 고정적인 주기로 호출되는 FixedUpdate가 있는 것입니다. 그리고 FixedUpdate에서는 주로 물리 연산을 수행합니다.



LateUpdate는 업데이트가 모두 끝난 후 계산을 하고 싶을 때 사용합니다. 예시로 플레이어를 따라가는 카메라를 구현한다고 가정했을 때 플레이어가 움직인 이후에 그에 따라 카메라가 계산을 수행해야합니다. 이런 경우 카메라가 플레이어를 따라가는 로직을 LateUpdate에 작성해 플레이어가 Update에서 움직이는 행동을 끝낸 후 카메라가 따라가게 구현할 수 있습니다.
